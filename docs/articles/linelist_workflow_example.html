<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>From raw linelist data to Re estimates • estimateR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="From raw linelist data to Re estimates">
<meta property="og:description" content="estimateR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimateR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/estimateR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparison_levels_input_details.html">Estimating Re using more or less detailed data</a>
    </li>
    <li>
      <a href="../articles/estimation_of_uncertainty.html">Available options for estimating uncertainty on Re estimates</a>
    </li>
    <li>
      <a href="../articles/incidence_data_workflow_example.html">From aggregated incidence data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/linelist_workflow_example.html">From raw linelist data to Re estimates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="linelist_workflow_example_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>From raw linelist data to Re estimates</h1>
            
      
      
      <div class="hidden name"><code>linelist_workflow_example.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we demonstrate a workflow for estimating Re from a linelist.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">estimateR</span><span class="op">)</span>

<span class="co"># Data handling packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="co"># Package for plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>The example is a synthetic version of a linelist of COVID-19 cases. The aggregated incidence of this linelist corresponds to or closely matches the incidence of Swiss cases as reported by the Federal Office of Public Health. To keep the data handling fast and easy, we restricted the simulated data from February to June 2020. The data is stored in the <code>CH_simulated_linelist</code> variable.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulated Swiss linelist</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CH_simulated_linelist</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 2</span>
<span class="co">#&gt;    confirmation_date symptom_onset_date</span>
<span class="co">#&gt;    &lt;date&gt;            &lt;date&gt;            </span>
<span class="co">#&gt;  1 2020-02-24        NA                </span>
<span class="co">#&gt;  2 2020-02-25        NA                </span>
<span class="co">#&gt;  3 2020-02-26        NA                </span>
<span class="co">#&gt;  4 2020-02-26        2020-02-17        </span>
<span class="co">#&gt;  5 2020-02-26        NA                </span>
<span class="co">#&gt;  6 2020-02-26        NA                </span>
<span class="co">#&gt;  7 2020-02-26        NA                </span>
<span class="co">#&gt;  8 2020-02-26        NA                </span>
<span class="co">#&gt;  9 2020-02-26        NA                </span>
<span class="co">#&gt; 10 2020-02-26        NA</span></code></pre></div>
<p>We transform the linelist into a dataframe that contains the daily incidence for case confirmations.</p>
<p>First, we construct the incidence of events of onset of symptoms for cases for which it is known.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">onset_incidence</span> <span class="op">&lt;-</span> <span class="va">CH_simulated_linelist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">symptom_onset_date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"onset_incidence"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">onset_incidence</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   date       onset_incidence</span>
<span class="co">#&gt;   &lt;date&gt;               &lt;int&gt;</span>
<span class="co">#&gt; 1 2020-02-17               2</span>
<span class="co">#&gt; 2 2020-02-18               1</span>
<span class="co">#&gt; 3 2020-02-19               1</span>
<span class="co">#&gt; 4 2020-02-20               3</span>
<span class="co">#&gt; 5 2020-02-21               4</span>
<span class="co">#&gt; 6 2020-02-22               2</span></code></pre></div>
<p>Then, we construct the incidence of events of case confirmation with no known symptom onset date.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">confirmation_incidence</span> <span class="op">&lt;-</span> <span class="va">CH_simulated_linelist</span> <span class="op">%&gt;%</span>
  <span class="co"># only keep report_date when we do not have the onset_date</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>confirmation_date <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">symptom_onset_date</span><span class="op">)</span>, <span class="va">confirmation_date</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">confirmation_date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"confirmation_incidence"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">confirmation_incidence</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   date       confirmation_incidence</span>
<span class="co">#&gt;   &lt;date&gt;                      &lt;int&gt;</span>
<span class="co">#&gt; 1 2020-02-24                      1</span>
<span class="co">#&gt; 2 2020-02-25                      1</span>
<span class="co">#&gt; 3 2020-02-26                      9</span>
<span class="co">#&gt; 4 2020-02-27                      8</span>
<span class="co">#&gt; 5 2020-02-28                      6</span>
<span class="co">#&gt; 6 2020-02-29                      8</span></code></pre></div>
<p>Now let us merge the two into a single dataframe. We need to make sure we align the two incidence vectors, and fill the missing dates with zero values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CH_incidence_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">onset_incidence</span>, <span class="va">confirmation_incidence</span>, by <span class="op">=</span> <span class="st">'date'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>onset_incidence <span class="op">=</span> <span class="fl">0</span>, confirmation_incidence <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, <span class="co"># add zeroes for dates with no reported case</span>
                  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,
                  by <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span>,
                  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>onset_incidence <span class="op">=</span> <span class="fl">0</span>,
                              confirmation_incidence <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">onset_incidence</span>, <span class="va">confirmation_incidence</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CH_incidence_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   date       onset_incidence confirmation_incidence</span>
<span class="co">#&gt;   &lt;date&gt;               &lt;dbl&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2020-02-17               2                      0</span>
<span class="co">#&gt; 2 2020-02-18               1                      0</span>
<span class="co">#&gt; 3 2020-02-19               1                      0</span>
<span class="co">#&gt; 4 2020-02-20               3                      0</span>
<span class="co">#&gt; 5 2020-02-21               4                      0</span>
<span class="co">#&gt; 6 2020-02-22               2                      0</span></code></pre></div>
<p>As a second step, we make use of the linelist to inform the analysis on the distribution of the delay between onset of symptom and case confirmation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CH_delay_data</span> <span class="op">&lt;-</span> <span class="va">CH_simulated_linelist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">symptom_onset_date</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">confirmation_date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>event_date <span class="op">=</span> <span class="va">symptom_onset_date</span>,
            report_date <span class="op">=</span> <span class="va">confirmation_date</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>report_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">report_date</span> <span class="op">-</span> <span class="va">event_date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>report_delay <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">report_delay</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, <span class="va">report_delay</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># curate negative delays</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">report_delay</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># remove NA values</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">report_date</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># rearrange dataset</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">event_date</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CH_delay_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   event_date report_delay</span>
<span class="co">#&gt;   &lt;date&gt;            &lt;int&gt;</span>
<span class="co">#&gt; 1 2020-02-17            9</span>
<span class="co">#&gt; 2 2020-02-17           14</span>
<span class="co">#&gt; 3 2020-02-18           17</span>
<span class="co">#&gt; 4 2020-02-19           21</span>
<span class="co">#&gt; 5 2020-02-20            8</span>
<span class="co">#&gt; 6 2020-02-20            9</span></code></pre></div>
<p>Additionally, we need to specify the incubation period for COVID-19 (TODO add ref) and the serial interval (TODO add ref).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Delay between infection and onset of symptoms (incubation period) in days</span>
<span class="co"># Gamma distribution parameter</span>
<span class="va">shape_incubation</span> <span class="op">&lt;-</span> <span class="fl">3.2</span>
<span class="va">scale_incubation</span> <span class="op">&lt;-</span> <span class="fl">1.3</span>

<span class="co"># Incubation period delay distribution</span>
<span class="va">distribution_incubation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"gamma"</span>, 
                                shape <span class="op">=</span> <span class="va">shape_incubation</span>, 
                                scale <span class="op">=</span> <span class="va">scale_incubation</span><span class="op">)</span>

<span class="co"># Serial interval (for Re estimation) in days</span>
<span class="va">mean_serial_interval</span> <span class="op">&lt;-</span> <span class="fl">4.8</span>
<span class="va">std_serial_interval</span> <span class="op">&lt;-</span> <span class="fl">2.3</span></code></pre></div>
<p>Now, we set some parameter of the analysis:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">estimation_window</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># 3-day sliding window for the Re estimation</span>
<span class="va">minimum_cumul_incidence</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># we start estimating Re after at least 100 cases have been recorded</span>
<span class="va">N_bootstrap_replicates</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># we take 100 replicates in the bootstrapping procedure</span>

<span class="co"># We specifiy the reference date (first date of data) and the time step of data.</span>
<span class="va">ref_date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">CH_incidence_data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>
<span class="va">time_step</span> <span class="op">=</span> <span class="st">"day"</span></code></pre></div>
<p>We can then perform the Re estimation. The computation should take a few seconds to complete.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CH_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_bootstrapped_estimates_from_combined_observations.html">get_bootstrapped_estimates_from_combined_observations</a></span><span class="op">(</span>
  partially_delayed_incidence <span class="op">=</span> <span class="va">CH_incidence_data</span><span class="op">$</span><span class="va">onset_incidence</span>,
  fully_delayed_incidence <span class="op">=</span> <span class="va">CH_incidence_data</span><span class="op">$</span><span class="va">confirmation_incidence</span>,
  N_bootstrap_replicates <span class="op">=</span> <span class="va">N_bootstrap_replicates</span>,
  delay_until_partial <span class="op">=</span> <span class="va">distribution_incubation</span>,
  delay_until_final_report <span class="op">=</span> <span class="va">CH_delay_data</span>,
  partial_observation_requires_full_observation <span class="op">=</span> <span class="cn">TRUE</span>,
  combine_bootstrap_and_estimation_uncertainties <span class="op">=</span> <span class="cn">TRUE</span>,
  estimation_window <span class="op">=</span> <span class="va">estimation_window</span>,
  minimum_cumul_incidence <span class="op">=</span> <span class="va">minimum_cumul_incidence</span>,
  mean_serial_interval <span class="op">=</span> <span class="va">mean_serial_interval</span>,
  std_serial_interval <span class="op">=</span> <span class="va">std_serial_interval</span>,
  ref_date <span class="op">=</span> <span class="va">ref_date</span>,
  time_step <span class="op">=</span> <span class="va">time_step</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CH_estimates</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   date       Re_estimate CI_down_Re_estimate CI_up_Re_estimate</span>
<span class="co">#&gt;   &lt;date&gt;           &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2020-02-21        3.05               2.35               3.74</span>
<span class="co">#&gt; 2 2020-02-22        2.53               1.20               3.86</span>
<span class="co">#&gt; 3 2020-02-23        2.28               1.59               2.98</span>
<span class="co">#&gt; 4 2020-02-24        2.33               1.91               2.75</span>
<span class="co">#&gt; 5 2020-02-25        2.63               0.748              4.51</span>
<span class="co">#&gt; 6 2020-02-26        3.00               1.64               4.36</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">CH_estimates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">Re_estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>lwd<span class="op">=</span>  <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, ymax <span class="op">=</span> <span class="va">CI_up_Re_estimate</span>, ymin <span class="op">=</span> <span class="va">CI_down_Re_estimate</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.45</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"2 weeks"</span>,
               date_labels <span class="op">=</span> <span class="st">'%b-%d\n%Y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Reproductive number"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="linelist_workflow_example_files/figure-html/unnamed-chunk-10-1.png" width="768"> TODO Summary</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jérémie Scire, Jana Huisman, Daniel Angst, Ana Grosu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
